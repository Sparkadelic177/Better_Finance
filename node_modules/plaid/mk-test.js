'use strict';

const plaid = require('./');

var plaidClient = new plaid.Client(process.env.PLAID_CLIENT_ID, process.env.PLAID_SECRET,
process.env.PLAID_PUBLIC_KEY, plaid.environments.sandbox, {version:
'2019-05-29', clientApp: 'Michael Test'});

// const ACCESS_TOKEN = 'access-development-7d11edec-17c4-487e-b91a-c4ba73bc535b';
let ACCESS_TOKEN = 'access-sandbox-520435c1-d3af-4fe6-b819-56e31785583a';

// plaidClient.getItem(ACCESS_TOKEN, (err, res) => {
//   console.log(JSON.stringify(err||res, null, 2));
// });

// Generate a public_token for an Item with customized accounts
plaidClient.sandboxPublicTokenCreate('ins_1', ['transactions'], {
  override_username: 'user_good',
  override_password: 'pass_good',
}, function(err, createResponse) {
  // Handle error, if present
  plaidClient.exchangePublicToken(createResponse.public_token, (err, resp) => {
    ACCESS_TOKEN = resp.access_token;
    plaidClient.getItem(ACCESS_TOKEN, (err, res) => {
      console.log(JSON.stringify(err||res, null, 2));
    });
    plaidClient.resetLogin(ACCESS_TOKEN, (err, suc) => {
      console.log(err||suc);
      plaidClient.getItem(ACCESS_TOKEN, (err, res) => {
        console.log(JSON.stringify(err||res, null, 2));
        plaidClient.getAuth(ACCESS_TOKEN, (err, res) => {
            console.log(err||res);
        });
      });
    })
  });
});
